var h=Object.defineProperty;var n=(o,i)=>h(o,"name",{value:i,configurable:!0});function d({getPaginatedOptionsUsing:o,perPage:i,loadingMessage:c="Loading..."}){return{offset:0,hasMore:!0,isLoadingMore:!1,currentSearch:null,loaderEl:null,init(){this.$nextTick(()=>{this.attachScrollListener(),this.attachSearchListener()})},attachScrollListener(){let e=this.$el;new MutationObserver(()=>{let t=e.querySelector(".fi-dropdown-panel");t&&!t.hasAttribute("data-scroll-attached")&&(t.setAttribute("data-scroll-attached","true"),t.addEventListener("scroll",()=>this.handleScroll(t)),this.offset===0&&this.hasMore&&this.loadMoreOptions())}).observe(e,{childList:!0,subtree:!0})},attachSearchListener(){let e=this.$el;new MutationObserver(()=>{let t=e.querySelector(".fi-select-input-search-ctn input");t&&!t.hasAttribute("data-search-attached")&&(t.setAttribute("data-search-attached","true"),t.addEventListener("input",s=>{this.currentSearch=s.target.value,this.offset=0,this.hasMore=!0}))}).observe(e,{childList:!0,subtree:!0})},handleScroll(e){if(this.isLoadingMore||!this.hasMore)return;e.scrollHeight-e.scrollTop-e.clientHeight<50&&this.loadMoreOptions()},showLoader(){let e=this.$el.querySelector(".fi-dropdown-panel ul");if(!e||this.loaderEl)return;this.loaderEl=document.createElement("li"),this.loaderEl.className="fi-dropdown-list-item fi-select-input-loading",this.loaderEl.style.cssText="text-align: center; padding: 0.75rem; color: var(--gray-500); display: flex; align-items: center; justify-content: center; gap: 0.5rem;";let r=document.createElement("span");r.innerHTML='<svg class="animate-spin" style="width: 1rem; height: 1rem;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle style="opacity: 0.25;" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path style="opacity: 0.75;" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';let t=document.createElement("span");t.textContent=c,this.loaderEl.appendChild(r),this.loaderEl.appendChild(t),e.appendChild(this.loaderEl)},hideLoader(){this.loaderEl&&(this.loaderEl.remove(),this.loaderEl=null)},async loadMoreOptions(){if(!(this.isLoadingMore||!this.hasMore)){this.isLoadingMore=!0,this.showLoader();try{let e=await o(this.offset,this.currentSearch),r=e.options??[];this.hasMore=e.hasMore??!1,this.hideLoader(),this.appendOptionsToDropdown(r),this.offset+=i}catch(e){console.error("Failed to load options:",e),this.hideLoader()}finally{this.isLoadingMore=!1}}},appendOptionsToDropdown(e){let r=this.$el.querySelector(".fi-dropdown-panel ul");r&&e.forEach(t=>{let s=document.createElement("li");s.className="fi-dropdown-list-item fi-select-input-option",s.setAttribute("role","option"),s.setAttribute("data-value",t.value),s.setAttribute("tabindex","0");let a=document.createElement("span");a.textContent=t.label,s.appendChild(a),s.addEventListener("click",l=>{l.preventDefault(),l.stopPropagation(),this.$dispatch("select-option",{value:t.value,label:t.label})}),r.appendChild(s)})}}}n(d,"infiniteScrollSelect");export{d as default};
